<!DOCTYPE html>
<html><head><title>C:\Users\micha\OneDrive\Dokumente\GitHub\matRad\matRad_version.m</title><STYLE TYPE="text/css"><!--TD{font-family: "Courier New", Courier, monospace; font-size: 10pt;}---></STYLE></head><body><p>(Back to <a href="index.html">index</a>)</p><h1>C:\Users\micha\OneDrive\Dokumente\GitHub\matRad\matRad_version.m</h1><p style="font-family:'Courier New'"><table>
<tr><th>Line</th><th>Code</th></tr>
<tr><td>1</td><td bgcolor="#FFFFFF">function&nbsp;[versionString,matRadVer]&nbsp;=&nbsp;matRad_version()</td></tr>
<tr><td>2</td><td bgcolor="#FFFFFF">%&nbsp;matRad&nbsp;function&nbsp;to&nbsp;get&nbsp;the&nbsp;current&nbsp;matRad&nbsp;version&nbsp;</td></tr>
<tr><td>3</td><td bgcolor="#FFFFFF">%&nbsp;(and&nbsp;git&nbsp;information&nbsp;when&nbsp;used&nbsp;from&nbsp;within&nbsp;a&nbsp;repository</td></tr>
<tr><td>4</td><td bgcolor="#FFFFFF">%&nbsp;</td></tr>
<tr><td>5</td><td bgcolor="#FFFFFF">%&nbsp;call</td></tr>
<tr><td>6</td><td bgcolor="#FFFFFF">%&nbsp;&nbsp;&nbsp;[versionString,matRadVer]&nbsp;=&nbsp;matRad_version()</td></tr>
<tr><td>7</td><td bgcolor="#FFFFFF">%</td></tr>
<tr><td>8</td><td bgcolor="#FFFFFF">%&nbsp;input</td></tr>
<tr><td>9</td><td bgcolor="#FFFFFF">%&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>10</td><td bgcolor="#FFFFFF">%&nbsp;output</td></tr>
<tr><td>11</td><td bgcolor="#FFFFFF">%&nbsp;&nbsp;&nbsp;versionString:&nbsp;&nbsp;Readable&nbsp;string&nbsp;build&nbsp;from&nbsp;version&nbsp;information</td></tr>
<tr><td>12</td><td bgcolor="#FFFFFF">%&nbsp;&nbsp;&nbsp;matRadVer:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;with&nbsp;version&nbsp;information</td></tr>
<tr><td>13</td><td bgcolor="#FFFFFF">%</td></tr>
<tr><td>14</td><td bgcolor="#FFFFFF">%&nbsp;References</td></tr>
<tr><td>15</td><td bgcolor="#FFFFFF">%&nbsp;&nbsp;&nbsp;-</td></tr>
<tr><td>16</td><td bgcolor="#FFFFFF">%</td></tr>
<tr><td>17</td><td bgcolor="#FFFFFF">%&nbsp;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</td></tr>
<tr><td>18</td><td bgcolor="#FFFFFF">%</td></tr>
<tr><td>19</td><td bgcolor="#FFFFFF">%&nbsp;Copyright&nbsp;2020&nbsp;the&nbsp;matRad&nbsp;development&nbsp;team.&nbsp;</td></tr>
<tr><td>20</td><td bgcolor="#FFFFFF">%&nbsp;</td></tr>
<tr><td>21</td><td bgcolor="#FFFFFF">%&nbsp;This&nbsp;file&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;matRad&nbsp;project.&nbsp;It&nbsp;is&nbsp;subject&nbsp;to&nbsp;the&nbsp;license&nbsp;</td></tr>
<tr><td>22</td><td bgcolor="#FFFFFF">%&nbsp;terms&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file&nbsp;found&nbsp;in&nbsp;the&nbsp;top-level&nbsp;directory&nbsp;of&nbsp;this&nbsp;</td></tr>
<tr><td>23</td><td bgcolor="#FFFFFF">%&nbsp;distribution&nbsp;and&nbsp;at&nbsp;https://github.com/e0404/matRad/LICENSES.txt.&nbsp;No&nbsp;part&nbsp;</td></tr>
<tr><td>24</td><td bgcolor="#FFFFFF">%&nbsp;of&nbsp;the&nbsp;matRad&nbsp;project,&nbsp;including&nbsp;this&nbsp;file,&nbsp;may&nbsp;be&nbsp;copied,&nbsp;modified,&nbsp;</td></tr>
<tr><td>25</td><td bgcolor="#FFFFFF">%&nbsp;propagated,&nbsp;or&nbsp;distributed&nbsp;except&nbsp;according&nbsp;to&nbsp;the&nbsp;terms&nbsp;contained&nbsp;in&nbsp;the&nbsp;</td></tr>
<tr><td>26</td><td bgcolor="#FFFFFF">%&nbsp;LICENSE&nbsp;file.</td></tr>
<tr><td>27</td><td bgcolor="#FFFFFF">%</td></tr>
<tr><td>28</td><td bgcolor="#FFFFFF">%&nbsp;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</td></tr>
<tr><td>29</td><td bgcolor="#FFFFFF"></td></tr>
<tr><td>30</td><td bgcolor="#FFFFFF">%Hardcoded&nbsp;version&nbsp;name&nbsp;/&nbsp;numbers</td></tr>
<tr><td>31</td><td bgcolor="#FF0000">matRadVer.name&nbsp;=&nbsp;'Blaise';</td></tr>
<tr><td>32</td><td bgcolor="#FF0000">matRadVer.major&nbsp;=&nbsp;2;</td></tr>
<tr><td>33</td><td bgcolor="#FF0000">matRadVer.minor&nbsp;=&nbsp;10;</td></tr>
<tr><td>34</td><td bgcolor="#FF0000">matRadVer.patch&nbsp;=&nbsp;1;</td></tr>
<tr><td>35</td><td bgcolor="#FFFFFF"></td></tr>
<tr><td>36</td><td bgcolor="#FF0000">tagged&nbsp;=&nbsp;false;</td></tr>
<tr><td>37</td><td bgcolor="#FFFFFF"></td></tr>
<tr><td>38</td><td bgcolor="#FFFFFF">%Retreive&nbsp;branch&nbsp;/&nbsp;commit&nbsp;information&nbsp;from&nbsp;current&nbsp;git&nbsp;repo&nbsp;if&nbsp;applicable</td></tr>
<tr><td>39</td><td bgcolor="#FF0000">try</td></tr>
<tr><td>40</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;%read&nbsp;HEAD&nbsp;file&nbsp;to&nbsp;point&nbsp;to&nbsp;current&nbsp;ref&nbsp;/&nbsp;commit</td></tr>
<tr><td>41</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;repoGitDir&nbsp;=&nbsp;[fileparts(mfilename('fullpath'))&nbsp;filesep&nbsp;'.git'];&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>42</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;headText&nbsp;=&nbsp;fileread([repoGitDir&nbsp;filesep&nbsp;'HEAD']);</td></tr>
<tr><td>43</td><td bgcolor="#FFFFFF"></td></tr>
<tr><td>44</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;%Test&nbsp;if&nbsp;detached&nbsp;head&nbsp;(HEAD&nbsp;contains&nbsp;40&nbsp;hex&nbsp;SHA1&nbsp;commit&nbsp;ID)&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>45</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;regexp(headText,'[a-f0-9]{40}',&nbsp;'once');</td></tr>
<tr><td>46</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;~isempty(i)</td></tr>
<tr><td>47</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matRadVer.branch&nbsp;=&nbsp;'DETACHED';</td></tr>
<tr><td>48</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matRadVer.commitID&nbsp;=&nbsp;headText(1:40);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>49</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;%HEAD&nbsp;contains&nbsp;reference&nbsp;to&nbsp;branch</td></tr>
<tr><td>50</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;headParse&nbsp;=&nbsp;textscan(headText,'%s');&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>51</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refHead&nbsp;=&nbsp;headParse{1}{2};</td></tr>
<tr><td>52</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refParse&nbsp;=&nbsp;strsplit(refHead,'/');</td></tr>
<tr><td>53</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matRadVer.branch&nbsp;=&nbsp;refParse{end};</td></tr>
<tr><td>54</td><td bgcolor="#FFFFFF"></td></tr>
<tr><td>55</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%Read&nbsp;ID&nbsp;from&nbsp;ref&nbsp;path</td></tr>
<tr><td>56</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refID&nbsp;=&nbsp;fileread([repoGitDir&nbsp;filesep&nbsp;strjoin(refParse,filesep)]);</td></tr>
<tr><td>57</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matRadVer.commitID&nbsp;=&nbsp;refID(1:40);</td></tr>
<tr><td>58</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>59</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%Check&nbsp;if&nbsp;we&nbsp;are&nbsp;on&nbsp;a&nbsp;tagged&nbsp;commit&nbsp;(i.e.,&nbsp;release)</td></tr>
<tr><td>60</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{</td></tr>
<tr><td>61</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagRefs&nbsp;=&nbsp;dir([repoGitDir&nbsp;filesep&nbsp;'refs'&nbsp;filesep&nbsp;'tags']);</td></tr>
<tr><td>62</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;t&nbsp;=&nbsp;1:numel(tagRefs)</td></tr>
<tr><td>63</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;~any(strcmp(tagRefs(t).name,&nbsp;{'.',&nbsp;'..'}))</td></tr>
<tr><td>64</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagId&nbsp;=&nbsp;fileread([repoGitDir&nbsp;filesep&nbsp;'refs'&nbsp;filesep&nbsp;'tags'&nbsp;filesep&nbsp;tagRefs(t).name]);</td></tr>
<tr><td>65</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;strcmp(tagId(1:40),matRadVer.commitID)</td></tr>
<tr><td>66</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagged=true;</td></tr>
<tr><td>67</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td></tr>
<tr><td>68</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</td></tr>
<tr><td>69</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</td></tr>
<tr><td>70</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</td></tr>
<tr><td>71</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%}</td></tr>
<tr><td>72</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>73</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;end</td></tr>
<tr><td>74</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>75</td><td bgcolor="#FF0000">catch</td></tr>
<tr><td>76</td><td bgcolor="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;%Git&nbsp;repo&nbsp;information&nbsp;could&nbsp;not&nbsp;be&nbsp;read,&nbsp;set&nbsp;to&nbsp;empty</td></tr>
<tr><td>77</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;matRadVer.branch&nbsp;=&nbsp;[];</td></tr>
<tr><td>78</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;matRadVer.commitID&nbsp;=&nbsp;[];</td></tr>
<tr><td>79</td><td bgcolor="#FFFFFF">end</td></tr>
<tr><td>80</td><td bgcolor="#FFFFFF"></td></tr>
<tr><td>81</td><td bgcolor="#FFFFFF">%Create&nbsp;a&nbsp;readable&nbsp;string</td></tr>
<tr><td>82</td><td bgcolor="#FFFFFF">%Git&nbsp;path&nbsp;first</td></tr>
<tr><td>83</td><td bgcolor="#FF0000">gitString&nbsp;=&nbsp;'';</td></tr>
<tr><td>84</td><td bgcolor="#FF0000">if&nbsp;~isempty(matRadVer.branch)&nbsp;&amp;&amp;&nbsp;~isempty(matRadVer.commitID)&nbsp;&amp;&amp;&nbsp;~tagged</td></tr>
<tr><td>85</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;gitString&nbsp;=&nbsp;sprintf('&nbsp;(%s-%s)',matRadVer.branch,matRadVer.commitID(1:8));&nbsp;&nbsp;</td></tr>
<tr><td>86</td><td bgcolor="#FFFFFF">end</td></tr>
<tr><td>87</td><td bgcolor="#FFFFFF"></td></tr>
<tr><td>88</td><td bgcolor="#FFFFFF">%Full&nbsp;string</td></tr>
<tr><td>89</td><td bgcolor="#FF0000">versionString&nbsp;=&nbsp;sprintf('v%d.%d.%d&nbsp;"%s"%s',matRadVer.major,matRadVer.minor,matRadVer.patch,matRadVer.name,gitString);</td></tr>
<tr><td>90</td><td bgcolor="#FFFFFF"></td></tr>
<tr><td>91</td><td bgcolor="#FFFFFF">%This&nbsp;checks&nbsp;if&nbsp;no&nbsp;explicit&nbsp;assigment&nbsp;is&nbsp;done&nbsp;in&nbsp;which&nbsp;case&nbsp;the&nbsp;version&nbsp;is&nbsp;printed.</td></tr>
<tr><td>92</td><td bgcolor="#FF0000">if&nbsp;nargout&nbsp;==&nbsp;0</td></tr>
<tr><td>93</td><td bgcolor="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;disp(['You&nbsp;are&nbsp;running&nbsp;matRad&nbsp;'&nbsp;versionString]);</td></tr>
<tr><td>94</td><td bgcolor="#FFFFFF">end</td></tr>
<tr><td>95</td><td bgcolor="#FFFFFF"></td></tr>
<tr><td>96</td><td bgcolor="#FFFFFF">end</td></tr>
<tr><td>97</td><td bgcolor="#FFFFFF"></td></tr>
</table></p></body></html>